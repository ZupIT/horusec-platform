package management

import (
	validation "github.com/go-ozzo/ozzo-validation/v4"
	"github.com/google/uuid"

	"github.com/ZupIT/horusec-devkit/pkg/enums/severities"
	vulnerabilityEnums "github.com/ZupIT/horusec-devkit/pkg/enums/vulnerability"
)

type VulnerabilityData struct {
	VulnerabilityID uuid.UUID               `json:"vulnerabilityID"`
	Severity        severities.Severity     `json:"severity" example:"CRITICAL" enums:"CRITICAL, HIGH, MEDIUM, LOW, INFO"`
	Type            vulnerabilityEnums.Type `json:"type" example:"Vulnerability" enums:"Vulnerability, Risk Accepted, False Positive, Corrected"` //nolint:lll // notations
}

func (v *VulnerabilityData) Validate() error {
	return validation.ValidateStruct(v,
		validation.Field(&v.VulnerabilityID, validation.Required, validation.NotIn(uuid.Nil)),
		validation.Field(&v.Severity, validation.In(severities.Critical, severities.Unknown,
			severities.High, severities.Medium, severities.Low, severities.Info)),
		validation.Field(&v.Type, validation.In(vulnerabilityEnums.Vulnerability, vulnerabilityEnums.RiskAccepted,
			vulnerabilityEnums.FalsePositive, vulnerabilityEnums.Corrected)))
}

func (v *VulnerabilityData) SetVulnerabilityID(vulnerabilityID uuid.UUID) {
	v.VulnerabilityID = vulnerabilityID
}
